image : maven:3.3.9-jdk-8-alpine

services:
    - mysql:8.0.0

stages:
    - test

run_java_tests:
    stage: test
    tags:
        - aws
    only:
        - master
    script:
        - mvn clean compile
        - mvn test-compile
        - mysql -u root iTrust < sql/dropTables.sql
        - mysql -u root iTrust < sql/createTables.sql
        - bash ./genTestData.sh
        - mvn test
        - mvn jacoco:report
        - cat target/site/jacoco/index.html

